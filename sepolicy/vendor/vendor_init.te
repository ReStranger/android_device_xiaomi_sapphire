allow vendor_init cgroup:file getattr;
allow vendor_init hwservicemanager:binder { transfer };
allow vendor_init tee_device:chr_file { ioctl };
allow vendor_init tee_device:chr_file rw_file_perms;

allow vendor_init vendor_dmabuf_qseecom_heap_device:chr_file ioctl;
allow vendor_init vendor_dmabuf_qseecom_heap_device:chr_file rw_file_perms;
allow vendor_init vendor_dmabuf_qseecom_ta_heap_device:chr_file ioctl;
allow vendor_init vendor_dmabuf_qseecom_ta_heap_device:chr_file rw_file_perms;
allow vendor_init vendor_qce_device:chr_file ioctl;
allow vendor_init vendor_qce_device:chr_file rw_file_perms;

set_prop(vendor_init, vendor_fp_prop)
set_prop(vendor_init, vendor_fp_info_prop)

# Allow init.qcom.usb.sh to create files in uvc.0
allow vendor_qti_init_shell configfs:dir create_dir_perms;
allow vendor_qti_init_shell configfs:{
  file
  lnk_file
} create_file_perms;

# dontaudit vendor_init to set the persist.traced.enable property
dontaudit vendor_init traced_enabled_prop:property_service set;

# dontaudit vendor_init to set the ro.debuggable property
dontaudit vendor_init userdebug_or_eng_prop:property_service set;

# Allow vendor_init to set the ro.vendor.qti.cgroup_follow.enable property
allow vendor_init vendor_cgroup_follow_prop:property_service set;

# dontaudit vendor_init to read the default_prop file
dontaudit vendor_init default_prop:file read;

# Allow vendor_init to write to the root directory of debugfs
allow vendor_init debugfs:dir write;

# Allow vendor_init to write to /proc/sys/kernel/sched_util_clamp_min_rt_default
allow vendor_init proc_sched:file write;

# dontaudit vendor_init to search the tombstones directory
dontaudit vendor_init tombstone_data_file:dir search;

# Allow vendor_init to get attributes for the character device /dev/qg
allow vendor_init vendor_qg_device:chr_file getattr;

# Allow init to write into vendor_sysfs_memory
allow init vendor_sysfs_memory:file write;

# Allow vold to write to vendor_sysfs_memory
allow vold vendor_sysfs_memory:file write;

dontaudit vendor_init default_prop:property_service set;
dontaudit vendor_init config_prop:property_service set;
